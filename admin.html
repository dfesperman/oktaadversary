<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Credential Harvesting Monitor</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a3e 50%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(120, 0, 255, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            display: flex;
            gap: 30px;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 280px;
            flex-shrink: 0;
        }

        .sidebar-menu {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.8) 0%, rgba(20, 20, 40, 0.8) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: sticky;
            top: 20px;
        }

        .sidebar-title {
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #7b7b8c;
            margin-bottom: 20px;
            padding: 0 10px;
        }

        .sidebar-item {
            padding: 14px 16px;
            margin-bottom: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #b0b0c0;
            font-size: 14px;
            font-weight: 500;
            border: 1px solid transparent;
        }

        .sidebar-item:hover {
            background: rgba(123, 47, 247, 0.1);
            border-color: rgba(123, 47, 247, 0.3);
            color: #e0e0e0;
            transform: translateX(5px);
        }

        .sidebar-item.active {
            background: linear-gradient(135deg, rgba(123, 47, 247, 0.3), rgba(0, 212, 255, 0.2));
            border-color: rgba(123, 47, 247, 0.5);
            color: #ffffff;
            box-shadow: 0 4px 15px rgba(123, 47, 247, 0.3);
        }

        .sidebar-item-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .sidebar-item-text {
            flex: 1;
        }

        .sidebar-badge {
            background: rgba(255, 193, 7, 0.3);
            color: #ffd43b;
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .main-content {
            flex: 1;
            min-width: 0;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Coming Soon Sections */
        .coming-soon-container {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.8) 0%, rgba(20, 20, 40, 0.8) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 80px 60px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .coming-soon-icon {
            font-size: 80px;
            margin-bottom: 30px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-20px);
            }
        }

        .coming-soon-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 20px;
            background: linear-gradient(135deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .coming-soon-text {
            font-size: 16px;
            color: #b0b0c0;
            line-height: 1.8;
            max-width: 600px;
            margin: 0 auto 30px;
        }

        .coming-soon-badge {
            display: inline-block;
            padding: 12px 30px;
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.3), rgba(255, 152, 0, 0.3));
            border: 1px solid rgba(255, 193, 7, 0.5);
            border-radius: 25px;
            color: #ffd43b;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 12px;
        }

        /* Responsive Sidebar */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }

            .sidebar-menu {
                position: static;
            }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.9) 0%, rgba(20, 20, 40, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 40px;
            margin: 0 auto 30px;
            max-width: 1400px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            z-index: 1;
        }

        .header-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
            background: linear-gradient(135deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header-subtitle {
            font-size: 16px;
            opacity: 0.8;
            line-height: 1.6;
            color: #b0b0c0;
        }

        .warning-banner {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(238, 90, 36, 0.2));
            backdrop-filter: blur(10px);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 20px rgba(238, 90, 36, 0.4);
            border: 1px solid rgba(255, 107, 107, 0.3);
        }

        /* Stats */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.8) 0%, rgba(20, 20, 40, 0.8) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7, #ff006e);
            opacity: 0.6;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.6),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .stat-value {
            font-size: 52px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: #a0a0b0;
        }

        /* Configuration Panel */
        .config-panel {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.8) 0%, rgba(20, 20, 40, 0.8) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .config-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #e0e0e0;
        }

        .config-form {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .config-input {
            flex: 1;
            min-width: 300px;
            padding: 14px 18px;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: rgba(10, 10, 25, 0.6);
            color: #e0e0e0;
            transition: all 0.3s ease;
        }

        .config-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .config-input:focus {
            outline: none;
            border-color: #7b2ff7;
            background: rgba(10, 10, 25, 0.8);
            box-shadow: 0 0 0 3px rgba(123, 47, 247, 0.2),
                        0 4px 12px rgba(0, 212, 255, 0.1);
        }

        .btn-update {
            background: linear-gradient(135deg, #ff9800, #ff5722);
            color: white;
            padding: 14px 28px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.3);
        }

        .btn-update:hover {
            background: linear-gradient(135deg, #fb8c00, #f4511e);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 152, 0, 0.5);
        }

        .config-status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 6px;
            font-size: 14px;
            display: none;
        }

        .config-status.success {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.5);
            color: #a8e6af;
        }

        .config-status.error {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.5);
            color: #ffb3ba;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .control-group {
            display: flex;
            gap: 10px;
        }

        button {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .btn-refresh {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-refresh:hover {
            background: linear-gradient(135deg, #218838, #17a2b8);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(40, 167, 69, 0.5);
        }

        .btn-clear {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }

        .btn-clear:hover {
            background: linear-gradient(135deg, #c82333, #bd2130);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.5);
        }

        .btn-export {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .btn-export:hover {
            background: linear-gradient(135deg, #0056b3, #004085);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.5);
        }

        .btn-back {
            background: linear-gradient(135deg, #6c757d, #5a6268);
            color: white;
        }

        .btn-back:hover {
            background: linear-gradient(135deg, #5a6268, #495057);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.5);
        }

        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 8px;
            background: rgba(10, 10, 25, 0.6);
            padding: 10px 18px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .auto-refresh input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Table */
        .table-container {
            background: linear-gradient(135deg, rgba(30, 30, 60, 0.8) 0%, rgba(20, 20, 40, 0.8) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4),
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.05);
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: linear-gradient(135deg, rgba(10, 10, 30, 0.6), rgba(20, 20, 40, 0.6));
        }

        th {
            padding: 18px 15px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 1.5px;
            border-bottom: 2px solid rgba(123, 47, 247, 0.3);
            color: #b0b0c0;
        }

        td {
            padding: 16px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            color: #d0d0d0;
        }

        tbody tr {
            transition: all 0.3s ease;
            animation: fadeIn 0.5s ease-in;
        }

        tbody tr:hover {
            background: rgba(123, 47, 247, 0.1);
            transform: scale(1.01);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .password-cell {
            font-family: 'Courier New', monospace;
            background: rgba(220, 53, 69, 0.3);
            padding: 6px 12px;
            border-radius: 6px;
            display: inline-block;
            border: 1px solid rgba(220, 53, 69, 0.4);
            color: #ff6b6b;
        }

        .username-cell {
            font-family: 'Courier New', monospace;
            background: rgba(40, 167, 69, 0.3);
            padding: 6px 12px;
            border-radius: 6px;
            display: inline-block;
            border: 1px solid rgba(40, 167, 69, 0.4);
            color: #51cf66;
        }

        .timestamp-cell {
            font-size: 12px;
            opacity: 0.7;
            color: #a0a0b0;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            opacity: 0.7;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .empty-state-text {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .empty-state-subtext {
            font-size: 14px;
            opacity: 0.7;
        }

        .badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-success {
            background: rgba(40, 167, 69, 0.3);
            border: 1px solid rgba(40, 167, 69, 0.5);
            color: #51cf66;
        }

        .badge-warning {
            background: rgba(255, 193, 7, 0.3);
            border: 1px solid rgba(255, 193, 7, 0.5);
            color: #ffd43b;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(40, 167, 69, 0.2);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
        }

        .live-dot {
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.3;
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @media (max-width: 768px) {
            .header-title {
                font-size: 24px;
            }

            .stats-container {
                grid-template-columns: 1fr;
            }

            .controls {
                flex-direction: column;
                align-items: stretch;
            }

            .control-group {
                flex-direction: column;
            }

            button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="header-title">
            <span>üõ°Ô∏è</span>
            OktaAdversary Admin Panel
        </h1>
        <p class="header-subtitle">
            This dashboard demonstrates how threat actors monitor and harvest credentials from phishing sites.
            All data shown here is captured from the simulated phishing login page for educational purposes.
        </p>
    </div>

    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="sidebar-menu">
                <div class="sidebar-title">Attack Vectors</div>
                <div class="sidebar-item active" onclick="showTab('aitm')">
                    <span class="sidebar-item-icon">üé£</span>
                    <span class="sidebar-item-text">Adversary-in-the-Middle</span>
                </div>
                <div class="sidebar-item" onclick="showTab('session-hijacking')">
                    <span class="sidebar-item-icon">üîì</span>
                    <span class="sidebar-item-text">Session Hijacking</span>
                </div>
                <div class="sidebar-item" onclick="showTab('credential-stuffing')">
                    <span class="sidebar-item-icon">üîë</span>
                    <span class="sidebar-item-text">Credential Stuffing & Password Spraying</span>
                </div>
                <div class="sidebar-item" onclick="showTab('mfa-fatigue')">
                    <span class="sidebar-item-icon">üì±</span>
                    <span class="sidebar-item-text">MFA Fatigue</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Adversary-in-the-Middle Tab Content -->
            <div id="tab-aitm" class="tab-content active">
                <div class="warning-banner">
            ‚ö†Ô∏è TRAINING ENVIRONMENT ONLY - No real credentials should ever be entered
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-value" id="totalCaptured">0</div>
                <div class="stat-label">Total Captured</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="todayCaptured">0</div>
                <div class="stat-label">Captured Today</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="lastCaptured">Never</div>
                <div class="stat-label">Last Capture</div>
            </div>
        </div>

        <div class="config-panel">
            <div class="config-title">
                <span>üé®</span>
                Phishing Page Configuration
            </div>
            <div class="config-form">
                <input
                    type="url"
                    id="targetUrl"
                    class="config-input"
                    placeholder="Enter target URL to model phishing page after (e.g., https://example.okta.com)"
                    value="https://environmentdemo.okta.com/"
                >
                <button class="btn-update" onclick="updatePhishingPage()">
                    <span>üîÑ</span>
                    Update UI
                </button>
            </div>
            <div class="config-status" id="configStatus"></div>
        </div>

        <div class="controls">
            <div class="control-group">
                <button class="btn-refresh" onclick="refreshData()">
                    <span>üîÑ</span>
                    Refresh
                </button>
                <button class="btn-export" onclick="exportData()">
                    <span>üì•</span>
                    Export CSV
                </button>
                <button class="btn-clear" onclick="clearData()">
                    <span>üóëÔ∏è</span>
                    Clear All
                </button>
                <button class="btn-back" onclick="window.location.href='index.html'">
                    <span>‚Üê</span>
                    Back to Phishing Demo
                </button>
            </div>
            <div class="auto-refresh">
                <input type="checkbox" id="autoRefresh" onchange="toggleAutoRefresh()">
                <label for="autoRefresh">Auto-refresh (5s)</label>
                <span class="live-indicator" id="liveIndicator" style="display: none;">
                    <span class="live-dot"></span>
                    LIVE
                </span>
            </div>
        </div>

        <div class="table-container">
            <table id="credentialsTable">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Timestamp</th>
                        <th>Username</th>
                        <th>Password</th>
                        <th>MFA Code</th>
                        <th>Remember Me</th>
                        <th>User Agent</th>
                        <th>Simulated IP</th>
                    </tr>
                </thead>
                <tbody id="credentialsBody">
                    <!-- Data will be inserted here -->
                </tbody>
            </table>
            <div class="empty-state" id="emptyState">
                <div class="empty-state-icon">üì≠</div>
                <div class="empty-state-text">No credentials captured yet</div>
                <div class="empty-state-subtext">Visit the phishing demo page and submit test credentials to see them appear here</div>
            </div>
        </div>
            </div>
            <!-- End Adversary-in-the-Middle Tab -->

            <!-- Credential Stuffing & Password Spraying Tab -->
            <div id="tab-credential-stuffing" class="tab-content">
                <div class="warning-banner">
                    ‚ö†Ô∏è TRAINING ENVIRONMENT ONLY - Demonstrates automated credential testing attacks
                </div>

                <!-- Target URL Configuration -->
                <div class="config-panel">
                    <div class="config-title">
                        <span>üéØ</span>
                        Target Configuration
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Target URL
                        </label>
                        <input
                            type="url"
                            id="credStuffingTargetUrl"
                            class="config-input"
                            placeholder="https://login.example.com"
                            value="https://login.okta.com"
                        >
                        <p style="color: #7b7b8c; font-size: 12px; margin-top: 8px;">
                            Specify the authentication endpoint you are targeting with this attack
                        </p>
                    </div>
                </div>

                <!-- Attack Mode Selector -->
                <div class="config-panel">
                    <div class="config-title">
                        <span>üîë</span>
                        Attack Mode Selection
                    </div>
                    <div style="display: flex; gap: 15px; margin-bottom: 20px;">
                        <button id="btnCredentialStuffing" class="btn-update" onclick="setAttackMode('credential-stuffing')" style="flex: 1;">
                            <span>üìã</span>
                            Credential Stuffing
                        </button>
                        <button id="btnPasswordSpraying" class="btn-export" onclick="setAttackMode('password-spraying')" style="flex: 1;">
                            <span>üíß</span>
                            Password Spraying
                        </button>
                    </div>
                    <div id="attackModeDescription" style="background: rgba(30, 30, 60, 0.5); padding: 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1); color: #b0b0c0; font-size: 13px; line-height: 1.6;">
                        Select an attack mode above to begin
                    </div>
                </div>

                <!-- Credential Stuffing Mode -->
                <div id="credentialStuffingMode" style="display: none;">
                    <div class="config-panel">
                        <div class="config-title">
                            <span>üìã</span>
                            Credential Stuffing Attack
                        </div>
                        <p style="color: #b0b0c0; margin-bottom: 20px; line-height: 1.6;">
                            Test a list of breached credentials against the target system. Each line should contain username:password pairs.
                        </p>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                                Credential List (username:password per line)
                            </label>
                            <textarea
                                id="credentialList"
                                class="config-input"
                                placeholder="user1@example.com:Password123&#10;user2@example.com:qwerty2024&#10;admin@example.com:Admin@2024"
                                style="min-height: 150px; font-family: 'Courier New', monospace; resize: vertical;"
                            ></textarea>
                        </div>

                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn-update" onclick="startCredentialStuffing()">
                                <span>üöÄ</span>
                                Start Attack
                            </button>
                            <button class="btn-export" onclick="loadSampleCredentials()">
                                <span>üì•</span>
                                Load Sample Data
                            </button>
                            <button class="btn-clear" onclick="clearCredentialStuffing()">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>

                        <div class="config-status" id="csStatus"></div>
                    </div>
                </div>

                <!-- Password Spraying Mode -->
                <div id="passwordSprayingMode" style="display: none;">
                    <div class="config-panel">
                        <div class="config-title">
                            <span>üíß</span>
                            Password Spraying Attack
                        </div>
                        <p style="color: #b0b0c0; margin-bottom: 20px; line-height: 1.6;">
                            Test common passwords against multiple user accounts to avoid account lockouts.
                        </p>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                                Target Usernames (one per line)
                            </label>
                            <textarea
                                id="targetUsernames"
                                class="config-input"
                                placeholder="user1@example.com&#10;admin@example.com&#10;john.doe@example.com"
                                style="min-height: 120px; font-family: 'Courier New', monospace; resize: vertical;"
                            ></textarea>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                                Common Passwords to Test
                            </label>
                            <textarea
                                id="commonPasswords"
                                class="config-input"
                                placeholder="Password123&#10;Summer2024&#10;Welcome1"
                                style="min-height: 120px; font-family: 'Courier New', monospace; resize: vertical;"
                            ></textarea>
                        </div>

                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn-update" onclick="startPasswordSpraying()">
                                <span>üöÄ</span>
                                Start Attack
                            </button>
                            <button class="btn-export" onclick="loadCommonPasswords()">
                                <span>üì•</span>
                                Load Top Passwords
                            </button>
                            <button class="btn-clear" onclick="clearPasswordSpraying()">
                                <span>üóëÔ∏è</span>
                                Clear
                            </button>
                        </div>

                        <div class="config-status" id="psStatus"></div>
                    </div>
                </div>

                <!-- Attack Progress -->
                <div id="attackProgress" style="display: none;">
                    <div class="config-panel">
                        <div class="config-title">
                            <span>‚è≥</span>
                            Attack in Progress
                        </div>
                        <div style="background: rgba(30, 30, 60, 0.5); padding: 20px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <span style="color: #b0b0c0;">Progress</span>
                                    <span style="color: #00d4ff; font-weight: 600;" id="progressText">0 / 0</span>
                                </div>
                                <div style="background: rgba(10, 10, 25, 0.6); height: 20px; border-radius: 10px; overflow: hidden;">
                                    <div id="progressBar" style="background: linear-gradient(90deg, #00d4ff, #7b2ff7); height: 100%; width: 0%; transition: width 0.3s;"></div>
                                </div>
                            </div>
                            <div style="color: #ffd43b; font-size: 13px; text-align: center;" id="progressStatus">Initializing attack...</div>
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="totalAttempts">0</div>
                        <div class="stat-label">Total Attempts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="successfulBreaches">0</div>
                        <div class="stat-label">Successful Breaches</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="successRate">0%</div>
                        <div class="stat-label">Success Rate</div>
                    </div>
                </div>

                <!-- Results Table -->
                <div class="table-container">
                    <h3 style="color: #e0e0e0; font-size: 18px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>üìä</span>
                        Attack Results
                    </h3>
                    <table id="attackResultsTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Timestamp</th>
                                <th>Target URL</th>
                                <th>Username</th>
                                <th>Password</th>
                                <th>Attack Type</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="attackResultsBody">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                    <div class="empty-state" id="attackEmptyState">
                        <div class="empty-state-icon">üîë</div>
                        <div class="empty-state-text">No attacks executed yet</div>
                        <div class="empty-state-subtext">Select an attack mode and configure the parameters to begin</div>
                    </div>
                </div>
            </div>

            <!-- MFA Fatigue Tab -->
            <div id="tab-mfa-fatigue" class="tab-content">
                <div class="warning-banner">
                    ‚ö†Ô∏è TRAINING ENVIRONMENT ONLY - Demonstrates MFA push notification bombardment attacks
                </div>

                <div class="config-panel">
                    <div class="config-title">
                        <span>üì±</span>
                        MFA Fatigue Attack Configuration
                    </div>
                    <p style="color: #b0b0c0; margin-bottom: 20px; line-height: 1.6;">
                        This attack exploits user frustration by sending multiple MFA push notifications in quick succession,
                        hoping the victim will approve one to stop the bombardment.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Target URL
                        </label>
                        <input
                            type="url"
                            id="mfaTargetUrl"
                            class="config-input"
                            placeholder="https://login.example.com"
                            value="https://login.okta.com"
                        >
                        <p style="color: #7b7b8c; font-size: 12px; margin-top: 8px;">
                            The authentication service being targeted with MFA push notifications
                        </p>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Target User
                        </label>
                        <input
                            type="text"
                            id="mfaTargetUser"
                            class="config-input"
                            placeholder="user@example.com"
                        >
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                                Number of Push Attempts
                            </label>
                            <input
                                type="number"
                                id="pushAttempts"
                                class="config-input"
                                placeholder="10"
                                value="10"
                                min="1"
                                max="50"
                            >
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                                Delay Between Pushes (seconds)
                            </label>
                            <input
                                type="number"
                                id="pushDelay"
                                class="config-input"
                                placeholder="3"
                                value="3"
                                min="1"
                                max="30"
                            >
                        </div>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Push Notification Message
                        </label>
                        <input
                            type="text"
                            id="pushMessage"
                            class="config-input"
                            placeholder="Login attempt from New York, NY"
                            value="Login attempt from New York, NY"
                        >
                    </div>

                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn-update" onclick="startMFAFatigue()" id="startMFABtn">
                            <span>üöÄ</span>
                            Start MFA Bombardment
                        </button>
                        <button class="btn-clear" onclick="stopMFAFatigue()" id="stopMFABtn" style="display: none;">
                            <span>‚èπÔ∏è</span>
                            Stop Attack
                        </button>
                        <button class="btn-clear" onclick="clearMFAFatigue()">
                            <span>üóëÔ∏è</span>
                            Clear
                        </button>
                    </div>

                    <div class="config-status" id="mfaStatus"></div>
                </div>

                <!-- Live Push Notifications Display -->
                <div id="pushNotificationsContainer" style="display: none;">
                    <div class="config-panel">
                        <div class="config-title">
                            <span>üì≤</span>
                            Live Push Notifications
                        </div>
                        <div id="pushNotifications" style="display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto;">
                            <!-- Push notifications will appear here -->
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="totalPushes">0</div>
                        <div class="stat-label">Total Push Notifications</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="approvedPushes">0</div>
                        <div class="stat-label">Approved by User</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="deniedPushes">0</div>
                        <div class="stat-label">Denied by User</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="ignoredPushes">0</div>
                        <div class="stat-label">Ignored (Timeout)</div>
                    </div>
                </div>

                <!-- Attack History Table -->
                <div class="table-container">
                    <h3 style="color: #e0e0e0; font-size: 18px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>üìú</span>
                        MFA Attack History
                    </h3>
                    <table id="mfaHistoryTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Timestamp</th>
                                <th>Target URL</th>
                                <th>Target User</th>
                                <th>Push Attempts</th>
                                <th>User Response</th>
                                <th>Time to Approval</th>
                                <th>Result</th>
                            </tr>
                        </thead>
                        <tbody id="mfaHistoryBody">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                    <div class="empty-state" id="mfaEmptyState">
                        <div class="empty-state-icon">üì±</div>
                        <div class="empty-state-text">No MFA fatigue attacks yet</div>
                        <div class="empty-state-subtext">Configure the attack parameters above and click "Start MFA Bombardment"</div>
                    </div>
                </div>
            </div>

            <!-- Session Hijacking Tab -->
            <div id="tab-session-hijacking" class="tab-content">
                <div class="warning-banner">
                    ‚ö†Ô∏è TRAINING ENVIRONMENT ONLY - This demonstrates session token replay attacks
                </div>

                <div class="config-panel">
                    <div class="config-title">
                        <span>üîì</span>
                        Session Cookie Replay Attack
                    </div>
                    <p style="color: #b0b0c0; margin-bottom: 20px; line-height: 1.6;">
                        This demonstration shows how attackers can steal session tokens/cookies and replay them
                        to impersonate authenticated users without needing their credentials. Paste a captured
                        session token below to simulate a session hijacking attack.
                    </p>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Session Token
                        </label>
                        <textarea
                            id="sessionToken"
                            class="config-input"
                            placeholder="Paste session token/cookie here (e.g., sid=abc123xyz...)"
                            style="min-height: 100px; font-family: 'Courier New', monospace; resize: vertical;"
                        ></textarea>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #e0e0e0;">
                            Target User (Optional)
                        </label>
                        <input
                            type="text"
                            id="targetUser"
                            class="config-input"
                            placeholder="e.g., user@example.com"
                        >
                    </div>

                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn-update" onclick="replaySession()">
                            <span>‚ñ∂Ô∏è</span>
                            Replay Session
                        </button>
                        <button class="btn-clear" onclick="clearSessionForm()">
                            <span>üóëÔ∏è</span>
                            Clear
                        </button>
                        <button class="btn-export" onclick="generateSampleToken()">
                            <span>üé≤</span>
                            Generate Sample Token
                        </button>
                    </div>

                    <div class="config-status" id="sessionStatus"></div>
                </div>

                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-value" id="totalReplays">0</div>
                        <div class="stat-label">Total Replays</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="successfulReplays">0</div>
                        <div class="stat-label">Successful Replays</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="lastReplay">Never</div>
                        <div class="stat-label">Last Replay</div>
                    </div>
                </div>

                <div class="table-container" id="replayResultContainer" style="display: none;">
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #00d4ff; font-size: 18px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span>‚úì</span>
                            Session Replay Result
                        </h3>
                        <div id="replayResult" style="font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.8;"></div>
                    </div>
                </div>

                <div class="table-container">
                    <h3 style="color: #e0e0e0; font-size: 18px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        <span>üìú</span>
                        Replay History
                    </h3>
                    <table id="sessionHistoryTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Timestamp</th>
                                <th>Target User</th>
                                <th>Token Preview</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sessionHistoryBody">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                    <div class="empty-state" id="sessionEmptyState">
                        <div class="empty-state-icon">üîì</div>
                        <div class="empty-state-text">No session replays yet</div>
                        <div class="empty-state-subtext">Paste a session token above and click "Replay Session" to simulate a session hijacking attack</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let autoRefreshInterval = null;

        // Tab switching functionality
        function showTab(tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });

            // Remove active class from all sidebar items
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected tab
            document.getElementById('tab-' + tabId).classList.add('active');

            // Add active class to clicked sidebar item
            event.currentTarget.classList.add('active');
        }

        // Load and display credentials
        function loadCredentials() {
            const credentials = JSON.parse(localStorage.getItem('capturedCredentials') || '[]');
            const tbody = document.getElementById('credentialsBody');
            const emptyState = document.getElementById('emptyState');

            if (credentials.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                updateStats(credentials);
                return;
            }

            emptyState.style.display = 'none';

            // Sort by timestamp (newest first)
            credentials.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            tbody.innerHTML = credentials.map((cred, index) => {
                const date = new Date(cred.timestamp);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();

                return `
                    <tr>
                        <td>${credentials.length - index}</td>
                        <td class="timestamp-cell">${formattedDate}</td>
                        <td><span class="username-cell">${escapeHtml(cred.username)}</span></td>
                        <td><span class="password-cell">${escapeHtml(cred.password)}</span></td>
                        <td>
                            ${cred.mfaCode
                                ? `<span style="font-family: 'Courier New', monospace; background: rgba(0, 212, 255, 0.3); padding: 6px 12px; border-radius: 6px; display: inline-block; border: 1px solid rgba(0, 212, 255, 0.4); color: #00d4ff; font-weight: 600;">${escapeHtml(cred.mfaCode)}</span>`
                                : '<span style="color: #7b7b8c; font-style: italic;">Not captured</span>'}
                        </td>
                        <td>
                            ${cred.remember
                                ? '<span class="badge badge-success">Yes</span>'
                                : '<span class="badge badge-warning">No</span>'}
                        </td>
                        <td style="font-size: 11px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${escapeHtml(cred.userAgent)}">
                            ${escapeHtml(cred.userAgent.substring(0, 50))}...
                        </td>
                        <td>${cred.ipSimulated || 'N/A'}</td>
                    </tr>
                `;
            }).join('');

            updateStats(credentials);
        }

        function updateStats(credentials) {
            // Total captured
            document.getElementById('totalCaptured').textContent = credentials.length;

            // Today's captures
            const today = new Date().toDateString();
            const todayCount = credentials.filter(cred =>
                new Date(cred.timestamp).toDateString() === today
            ).length;
            document.getElementById('todayCaptured').textContent = todayCount;

            // Last captured
            if (credentials.length > 0) {
                const lastTimestamp = new Date(credentials[credentials.length - 1].timestamp);
                const now = new Date();
                const diffMs = now - lastTimestamp;
                const diffMins = Math.floor(diffMs / 60000);

                let timeAgo;
                if (diffMins < 1) {
                    timeAgo = 'Just now';
                } else if (diffMins < 60) {
                    timeAgo = `${diffMins}m ago`;
                } else if (diffMins < 1440) {
                    timeAgo = `${Math.floor(diffMins / 60)}h ago`;
                } else {
                    timeAgo = `${Math.floor(diffMins / 1440)}d ago`;
                }

                document.getElementById('lastCaptured').textContent = timeAgo;
                document.getElementById('lastCaptured').style.fontSize = '24px';
            } else {
                document.getElementById('lastCaptured').textContent = 'Never';
            }
        }

        function refreshData() {
            loadCredentials();

            // Visual feedback
            const btn = event.target.closest('button');
            btn.style.transform = 'rotate(360deg)';
            setTimeout(() => {
                btn.style.transform = '';
            }, 500);
        }

        function clearData() {
            if (confirm('‚ö†Ô∏è Are you sure you want to clear all captured credentials?\n\nThis action cannot be undone.')) {
                localStorage.removeItem('capturedCredentials');
                loadCredentials();
            }
        }

        function exportData() {
            const credentials = JSON.parse(localStorage.getItem('capturedCredentials') || '[]');

            if (credentials.length === 0) {
                alert('No data to export!');
                return;
            }

            // Create CSV content
            const headers = ['Timestamp', 'Username', 'Password', 'MFA Code', 'Remember Me', 'User Agent', 'Simulated IP'];
            const csvContent = [
                headers.join(','),
                ...credentials.map(cred => [
                    new Date(cred.timestamp).toISOString(),
                    `"${cred.username}"`,
                    `"${cred.password}"`,
                    cred.mfaCode ? `"${cred.mfaCode}"` : 'N/A',
                    cred.remember ? 'Yes' : 'No',
                    `"${cred.userAgent}"`,
                    cred.ipSimulated || 'N/A'
                ].join(','))
            ].join('\n');

            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `captured-credentials-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function updatePhishingPage() {
            const targetUrl = document.getElementById('targetUrl').value;
            const statusDiv = document.getElementById('configStatus');

            if (!targetUrl || !targetUrl.startsWith('http')) {
                statusDiv.textContent = '‚ùå Please enter a valid URL starting with http:// or https://';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
                return;
            }

            // Store the target URL in localStorage
            localStorage.setItem('phishingTargetUrl', targetUrl);

            // Show success message
            statusDiv.textContent = `‚úì Configuration saved! The phishing page will now model itself after: ${targetUrl}`;
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';

            // Trigger reload notification
            setTimeout(() => {
                if (confirm('Configuration saved successfully!\n\nWould you like to open the phishing demo page to see the changes?')) {
                    window.open('index.html', '_blank');
                }
            }, 1000);
        }

        function toggleAutoRefresh() {
            const checkbox = document.getElementById('autoRefresh');
            const liveIndicator = document.getElementById('liveIndicator');

            if (checkbox.checked) {
                autoRefreshInterval = setInterval(loadCredentials, 5000);
                liveIndicator.style.display = 'inline-flex';
            } else {
                if (autoRefreshInterval) {
                    clearInterval(autoRefreshInterval);
                    autoRefreshInterval = null;
                }
                liveIndicator.style.display = 'none';
            }
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, m => map[m]);
        }

        // Load data on page load
        loadCredentials();
        loadSessionHistory();

        // Listen for storage changes (when credentials are captured in another tab)
        window.addEventListener('storage', function(e) {
            if (e.key === 'capturedCredentials') {
                loadCredentials();
            }
            if (e.key === 'sessionReplays') {
                loadSessionHistory();
            }
        });

        // Session Hijacking Functions
        function generateSampleToken() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let token = 'sid=';
            for (let i = 0; i < 64; i++) {
                token += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            token += '; Path=/; Secure; HttpOnly; SameSite=Strict';

            document.getElementById('sessionToken').value = token;
            document.getElementById('targetUser').value = 'user@example.com';

            const statusDiv = document.getElementById('sessionStatus');
            statusDiv.textContent = '‚úì Sample session token generated';
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        function clearSessionForm() {
            document.getElementById('sessionToken').value = '';
            document.getElementById('targetUser').value = '';
            document.getElementById('replayResultContainer').style.display = 'none';
        }

        function replaySession() {
            const token = document.getElementById('sessionToken').value.trim();
            const targetUser = document.getElementById('targetUser').value.trim();
            const statusDiv = document.getElementById('sessionStatus');

            if (!token) {
                statusDiv.textContent = '‚ùå Please enter a session token';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
                return;
            }

            // Simulate session replay
            const replayData = {
                token: token,
                targetUser: targetUser || 'Unknown User',
                timestamp: new Date().toISOString(),
                success: true,
                sessionInfo: {
                    authenticatedAs: targetUser || 'Unknown User',
                    sessionId: extractSessionId(token),
                    expiresIn: Math.floor(Math.random() * 3600) + 1800, // Random 30-90 mins
                    permissions: ['read', 'write', 'admin'],
                    ipAddress: '192.168.1.' + Math.floor(Math.random() * 255),
                    userAgent: navigator.userAgent
                }
            };

            // Store replay in history
            let replays = JSON.parse(localStorage.getItem('sessionReplays') || '[]');
            replays.push(replayData);
            localStorage.setItem('sessionReplays', JSON.stringify(replays));

            // Show success message
            statusDiv.textContent = '‚úì Session successfully replayed! User session hijacked.';
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';

            // Display replay result
            displayReplayResult(replayData);

            // Update history and stats
            loadSessionHistory();

            // Clear form after 2 seconds
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }

        function extractSessionId(token) {
            const match = token.match(/sid=([^;]+)/);
            return match ? match[1].substring(0, 16) + '...' : 'unknown';
        }

        function displayReplayResult(data) {
            const container = document.getElementById('replayResultContainer');
            const resultDiv = document.getElementById('replayResult');

            const expiryTime = new Date(Date.now() + data.sessionInfo.expiresIn * 1000);

            resultDiv.innerHTML = `
                <div style="background: rgba(40, 167, 69, 0.2); border: 1px solid rgba(40, 167, 69, 0.5); padding: 20px; border-radius: 8px; margin-bottom: 15px;">
                    <div style="color: #51cf66; font-weight: 600; margin-bottom: 10px;">üéØ Session Hijack Successful</div>
                    <div style="color: #b0b0c0;">You have successfully impersonated the authenticated user.</div>
                </div>

                <div style="background: rgba(30, 30, 60, 0.5); padding: 15px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1);">
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Authenticated As:</span>
                        <span style="color: #00d4ff; font-weight: 600; margin-left: 10px;">${escapeHtml(data.sessionInfo.authenticatedAs)}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Session ID:</span>
                        <span style="color: #ffd43b; margin-left: 10px;">${escapeHtml(data.sessionInfo.sessionId)}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Expires In:</span>
                        <span style="color: #ff6b6b; margin-left: 10px;">${Math.floor(data.sessionInfo.expiresIn / 60)} minutes</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Expiry Time:</span>
                        <span style="color: #a0a0b0; margin-left: 10px;">${expiryTime.toLocaleString()}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Permissions:</span>
                        <span style="color: #51cf66; margin-left: 10px;">${data.sessionInfo.permissions.join(', ')}</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <span style="color: #7b7b8c;">Source IP:</span>
                        <span style="color: #a0a0b0; margin-left: 10px;">${data.sessionInfo.ipAddress}</span>
                    </div>
                </div>

                <div style="margin-top: 20px; padding: 15px; background: rgba(255, 193, 7, 0.1); border: 1px solid rgba(255, 193, 7, 0.3); border-radius: 8px;">
                    <div style="color: #ffd43b; font-weight: 600; margin-bottom: 8px;">‚ö†Ô∏è Attack Vector Explanation</div>
                    <div style="color: #b0b0c0; font-size: 12px; line-height: 1.6;">
                        Session hijacking allows attackers to bypass authentication by stealing or intercepting valid session tokens.
                        This can be achieved through XSS attacks, network sniffing, malware, or physical access to devices.
                        Once obtained, the token grants full access to the user's account without requiring credentials.
                    </div>
                </div>
            `;

            container.style.display = 'block';
            container.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function loadSessionHistory() {
            const replays = JSON.parse(localStorage.getItem('sessionReplays') || '[]');
            const tbody = document.getElementById('sessionHistoryBody');
            const emptyState = document.getElementById('sessionEmptyState');

            // Update stats
            document.getElementById('totalReplays').textContent = replays.length;
            document.getElementById('successfulReplays').textContent = replays.filter(r => r.success).length;

            if (replays.length > 0) {
                const lastReplay = new Date(replays[replays.length - 1].timestamp);
                const now = new Date();
                const diffMs = now - lastReplay;
                const diffMins = Math.floor(diffMs / 60000);

                let timeAgo;
                if (diffMins < 1) {
                    timeAgo = 'Just now';
                } else if (diffMins < 60) {
                    timeAgo = `${diffMins}m ago`;
                } else if (diffMins < 1440) {
                    timeAgo = `${Math.floor(diffMins / 60)}h ago`;
                } else {
                    timeAgo = `${Math.floor(diffMins / 1440)}d ago`;
                }

                document.getElementById('lastReplay').textContent = timeAgo;
                document.getElementById('lastReplay').style.fontSize = '24px';
            }

            if (replays.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';

            // Sort by timestamp (newest first)
            replays.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            tbody.innerHTML = replays.map((replay, index) => {
                const date = new Date(replay.timestamp);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                const tokenPreview = extractSessionId(replay.token);

                return `
                    <tr>
                        <td>${replays.length - index}</td>
                        <td class="timestamp-cell">${formattedDate}</td>
                        <td><span class="username-cell">${escapeHtml(replay.targetUser)}</span></td>
                        <td style="font-family: 'Courier New', monospace; font-size: 11px; color: #ffd43b;">${escapeHtml(tokenPreview)}</td>
                        <td>
                            ${replay.success
                                ? '<span class="badge badge-success">Success</span>'
                                : '<span class="badge badge-warning">Failed</span>'}
                        </td>
                        <td>
                            <button onclick="viewReplayDetails(${replays.length - index - 1})" style="padding: 6px 12px; font-size: 11px; background: linear-gradient(135deg, #007bff, #0056b3); color: white; border: none; border-radius: 4px; cursor: pointer;">
                                View Details
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function viewReplayDetails(index) {
            const replays = JSON.parse(localStorage.getItem('sessionReplays') || '[]');
            replays.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            if (index >= 0 && index < replays.length) {
                displayReplayResult(replays[index]);
            }
        }

        // Credential Stuffing & Password Spraying Functions
        let currentAttackMode = null;

        function setAttackMode(mode) {
            currentAttackMode = mode;

            // Update button styles
            const csBtn = document.getElementById('btnCredentialStuffing');
            const psBtn = document.getElementById('btnPasswordSpraying');

            if (mode === 'credential-stuffing') {
                csBtn.style.opacity = '1';
                psBtn.style.opacity = '0.5';
                document.getElementById('credentialStuffingMode').style.display = 'block';
                document.getElementById('passwordSprayingMode').style.display = 'none';
                document.getElementById('attackModeDescription').innerHTML = `
                    <strong style="color: #00d4ff;">Credential Stuffing:</strong> Tests a list of username:password pairs obtained from data breaches
                    against the target system. Attackers use this technique because users often reuse passwords across multiple services.
                `;
            } else {
                csBtn.style.opacity = '0.5';
                psBtn.style.opacity = '1';
                document.getElementById('credentialStuffingMode').style.display = 'none';
                document.getElementById('passwordSprayingMode').style.display = 'block';
                document.getElementById('attackModeDescription').innerHTML = `
                    <strong style="color: #00d4ff;">Password Spraying:</strong> Tests a small set of common passwords against many user accounts.
                    This approach avoids account lockouts by attempting only a few passwords per account, staying under typical lockout thresholds.
                `;
            }
        }

        function loadSampleCredentials() {
            const samples = `john.doe@company.com:Password123
sarah.smith@company.com:Summer2024!
admin@company.com:Admin@123
michael.jones@company.com:Welcome1
jessica.brown@company.com:Qwerty2024
david.wilson@company.com:Company2024!`;

            document.getElementById('credentialList').value = samples;
        }

        function loadCommonPasswords() {
            const usernames = `john.doe@company.com
admin@company.com
sarah.smith@company.com
michael.jones@company.com
jessica.brown@company.com`;

            const passwords = `Password123
Welcome1
Summer2024
Company2024
Qwerty123`;

            document.getElementById('targetUsernames').value = usernames;
            document.getElementById('commonPasswords').value = passwords;
        }

        async function startCredentialStuffing() {
            const credList = document.getElementById('credentialList').value.trim();
            const targetUrl = document.getElementById('credStuffingTargetUrl').value.trim();
            const statusDiv = document.getElementById('csStatus');

            if (!targetUrl) {
                statusDiv.textContent = '‚ùå Please enter a target URL';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            if (!credList) {
                statusDiv.textContent = '‚ùå Please enter credential pairs';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            const credentials = credList.split('\n').filter(line => line.includes(':'));
            if (credentials.length === 0) {
                statusDiv.textContent = '‚ùå Invalid format. Use username:password per line';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            statusDiv.textContent = `‚úì Attack started against ${targetUrl}...`;
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';

            document.getElementById('attackProgress').style.display = 'block';
            await simulateAttack(credentials, 'credential-stuffing', targetUrl);

            setTimeout(() => statusDiv.style.display = 'none', 3000);
        }

        async function startPasswordSpraying() {
            const targetUrl = document.getElementById('credStuffingTargetUrl').value.trim();
            const usernames = document.getElementById('targetUsernames').value.trim().split('\n').filter(u => u);
            const passwords = document.getElementById('commonPasswords').value.trim().split('\n').filter(p => p);
            const statusDiv = document.getElementById('psStatus');

            if (!targetUrl) {
                statusDiv.textContent = '‚ùå Please enter a target URL';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            if (!usernames.length || !passwords.length) {
                statusDiv.textContent = '‚ùå Please enter both usernames and passwords';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            statusDiv.textContent = `‚úì Attack started against ${targetUrl}...`;
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';

            // Generate credential pairs
            const credentials = [];
            for (const password of passwords) {
                for (const username of usernames) {
                    credentials.push(`${username}:${password}`);
                }
            }

            document.getElementById('attackProgress').style.display = 'block';
            await simulateAttack(credentials, 'password-spraying', targetUrl);

            setTimeout(() => statusDiv.style.display = 'none', 3000);
        }

        async function simulateAttack(credentials, attackType, targetUrl) {
            const total = credentials.length;
            let successful = 0;

            for (let i = 0; i < credentials.length; i++) {
                const [username, password] = credentials[i].split(':');

                // Update progress
                const progress = ((i + 1) / total) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
                document.getElementById('progressText').textContent = `${i + 1} / ${total}`;
                document.getElementById('progressStatus').textContent = `Testing ${username} against ${targetUrl}...`;

                // Simulate random success (5% success rate for realism)
                const success = Math.random() < 0.05;
                if (success) successful++;

                // Store result
                const result = {
                    username,
                    password,
                    attackType,
                    targetUrl,
                    success,
                    timestamp: new Date().toISOString()
                };

                let results = JSON.parse(localStorage.getItem('attackResults') || '[]');
                results.push(result);
                localStorage.setItem('attackResults', JSON.stringify(results));

                // Delay to simulate real attack
                await new Promise(resolve => setTimeout(resolve, 300));
            }

            // Hide progress, show results
            document.getElementById('attackProgress').style.display = 'none';
            loadAttackResults();

            alert(`Attack completed against ${targetUrl}!\n\nTotal attempts: ${total}\nSuccessful breaches: ${successful}\nSuccess rate: ${((successful/total)*100).toFixed(1)}%`);
        }

        function loadAttackResults() {
            const results = JSON.parse(localStorage.getItem('attackResults') || '[]');
            const tbody = document.getElementById('attackResultsBody');
            const emptyState = document.getElementById('attackEmptyState');

            // Update stats
            document.getElementById('totalAttempts').textContent = results.length;
            const successful = results.filter(r => r.success).length;
            document.getElementById('successfulBreaches').textContent = successful;
            document.getElementById('successRate').textContent = results.length > 0
                ? ((successful / results.length) * 100).toFixed(1) + '%'
                : '0%';

            if (results.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';

            // Sort by timestamp (newest first)
            results.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

            tbody.innerHTML = results.map((result, index) => {
                const date = new Date(result.timestamp);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();

                return `
                    <tr>
                        <td>${results.length - index}</td>
                        <td class="timestamp-cell">${formattedDate}</td>
                        <td style="font-size: 11px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${escapeHtml(result.targetUrl || 'N/A')}">
                            ${result.targetUrl ? escapeHtml(result.targetUrl) : '<span style="color: #7b7b8c;">N/A</span>'}
                        </td>
                        <td><span class="username-cell">${escapeHtml(result.username)}</span></td>
                        <td><span class="password-cell">${escapeHtml(result.password)}</span></td>
                        <td style="text-transform: capitalize;">${result.attackType.replace('-', ' ')}</td>
                        <td>
                            ${result.success
                                ? '<span class="badge badge-success">Success</span>'
                                : '<span class="badge badge-warning">Failed</span>'}
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function clearCredentialStuffing() {
            document.getElementById('credentialList').value = '';
        }

        function clearPasswordSpraying() {
            document.getElementById('targetUsernames').value = '';
            document.getElementById('commonPasswords').value = '';
        }

        // MFA Fatigue Functions
        let mfaAttackInterval = null;
        let mfaAttackData = null;

        async function startMFAFatigue() {
            const targetUrl = document.getElementById('mfaTargetUrl').value.trim();
            const targetUser = document.getElementById('mfaTargetUser').value.trim();
            const pushAttempts = parseInt(document.getElementById('pushAttempts').value);
            const pushDelay = parseInt(document.getElementById('pushDelay').value);
            const pushMessage = document.getElementById('pushMessage').value.trim();
            const statusDiv = document.getElementById('mfaStatus');

            if (!targetUrl) {
                statusDiv.textContent = '‚ùå Please enter a target URL';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            if (!targetUser) {
                statusDiv.textContent = '‚ùå Please enter a target user';
                statusDiv.className = 'config-status error';
                statusDiv.style.display = 'block';
                setTimeout(() => statusDiv.style.display = 'none', 5000);
                return;
            }

            // Initialize attack data
            mfaAttackData = {
                targetUrl,
                targetUser,
                pushAttempts,
                pushDelay,
                pushMessage,
                startTime: new Date().toISOString(),
                pushCount: 0,
                approved: 0,
                denied: 0,
                ignored: 0,
                userApprovedAt: null
            };

            statusDiv.textContent = `‚úì MFA bombardment started against ${targetUrl}...`;
            statusDiv.className = 'config-status success';
            statusDiv.style.display = 'block';

            // Show notifications container
            document.getElementById('pushNotificationsContainer').style.display = 'block';
            document.getElementById('pushNotifications').innerHTML = '';

            // Toggle buttons
            document.getElementById('startMFABtn').style.display = 'none';
            document.getElementById('stopMFABtn').style.display = 'inline-flex';

            // Start sending push notifications
            await sendMFAPushes();
        }

        async function sendMFAPushes() {
            for (let i = 0; i < mfaAttackData.pushAttempts; i++) {
                if (!mfaAttackData) break; // Attack was stopped

                mfaAttackData.pushCount++;

                // Create push notification
                const pushDiv = document.createElement('div');
                pushDiv.style.cssText = `
                    background: linear-gradient(135deg, rgba(30, 30, 60, 0.8), rgba(20, 20, 40, 0.8));
                    border: 1px solid rgba(0, 212, 255, 0.3);
                    border-radius: 8px;
                    padding: 15px;
                    animation: slideIn 0.3s ease-out;
                `;

                const pushId = mfaAttackData.pushCount;
                const userWillApprove = !mfaAttackData.userApprovedAt && (i >= 7 || Math.random() < 0.15); // Higher chance after 7+ attempts

                pushDiv.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                        <span style="font-size: 24px;">üì±</span>
                        <div style="flex: 1;">
                            <div style="color: #00d4ff; font-weight: 600;">Push Notification #${pushId}</div>
                            <div style="color: #b0b0c0; font-size: 12px;">${new Date().toLocaleTimeString()}</div>
                        </div>
                        <span class="badge badge-warning" id="status-${pushId}">Pending</span>
                    </div>
                    <div style="color: #e0e0e0; margin-bottom: 10px;">${escapeHtml(mfaAttackData.pushMessage)}</div>
                    <div style="color: #7b7b8c; font-size: 11px; margin-bottom: 5px;">Service: ${escapeHtml(mfaAttackData.targetUrl)}</div>
                    <div style="color: #7b7b8c; font-size: 11px;">To: ${escapeHtml(mfaAttackData.targetUser)}</div>
                `;

                document.getElementById('pushNotifications').insertBefore(
                    pushDiv,
                    document.getElementById('pushNotifications').firstChild
                );

                // Simulate user response after a delay
                setTimeout(() => {
                    const statusBadge = document.getElementById(`status-${pushId}`);
                    if (userWillApprove && !mfaAttackData.userApprovedAt) {
                        // User approved this push (fatigue attack succeeded!)
                        statusBadge.textContent = 'Approved';
                        statusBadge.className = 'badge badge-success';
                        mfaAttackData.approved++;
                        mfaAttackData.userApprovedAt = new Date().toISOString();
                        pushDiv.style.borderColor = 'rgba(40, 167, 69, 0.5)';

                        // Stop attack since user approved
                        setTimeout(() => stopMFAFatigue(true), 1000);
                    } else if (Math.random() < 0.3) {
                        // User denied
                        statusBadge.textContent = 'Denied';
                        statusBadge.className = 'badge badge-warning';
                        mfaAttackData.denied++;
                        pushDiv.style.borderColor = 'rgba(255, 193, 7, 0.5)';
                    } else {
                        // User ignored (timeout)
                        statusBadge.textContent = 'Timeout';
                        statusBadge.style.background = 'rgba(108, 117, 125, 0.3)';
                        statusBadge.style.borderColor = 'rgba(108, 117, 125, 0.5)';
                        statusBadge.style.color = '#a0a0b0';
                        mfaAttackData.ignored++;
                        pushDiv.style.borderColor = 'rgba(108, 117, 125, 0.3)';
                    }
                    updateMFAStats();
                }, 2000 + Math.random() * 3000);

                // Wait before sending next push
                await new Promise(resolve => setTimeout(resolve, mfaAttackData.pushDelay * 1000));
            }

            // Attack completed
            if (mfaAttackData && !mfaAttackData.userApprovedAt) {
                setTimeout(() => stopMFAFatigue(false), 2000);
            }
        }

        function stopMFAFatigue(success = false) {
            if (!mfaAttackData) return;

            // Save to history
            const attackRecord = {
                ...mfaAttackData,
                endTime: new Date().toISOString(),
                success: !!mfaAttackData.userApprovedAt,
                timeToApproval: mfaAttackData.userApprovedAt
                    ? (new Date(mfaAttackData.userApprovedAt) - new Date(mfaAttackData.startTime)) / 1000
                    : null
            };

            let history = JSON.parse(localStorage.getItem('mfaHistory') || '[]');
            history.push(attackRecord);
            localStorage.setItem('mfaHistory', JSON.stringify(history));

            // Show result
            const statusDiv = document.getElementById('mfaStatus');
            if (success) {
                statusDiv.textContent = 'üéØ Attack succeeded! User approved the MFA request.';
                statusDiv.className = 'config-status success';
                alert('MFA Fatigue Attack Successful!\n\nThe user approved a push notification after being bombarded with multiple requests.');
            } else {
                statusDiv.textContent = '‚ùå Attack failed. User did not approve any requests.';
                statusDiv.className = 'config-status error';
            }
            statusDiv.style.display = 'block';
            setTimeout(() => statusDiv.style.display = 'none', 8000);

            // Reset
            mfaAttackData = null;
            document.getElementById('startMFABtn').style.display = 'inline-flex';
            document.getElementById('stopMFABtn').style.display = 'none';

            loadMFAHistory();
        }

        function updateMFAStats() {
            document.getElementById('totalPushes').textContent = mfaAttackData ? mfaAttackData.pushCount : 0;
            document.getElementById('approvedPushes').textContent = mfaAttackData ? mfaAttackData.approved : 0;
            document.getElementById('deniedPushes').textContent = mfaAttackData ? mfaAttackData.denied : 0;
            document.getElementById('ignoredPushes').textContent = mfaAttackData ? mfaAttackData.ignored : 0;
        }

        function loadMFAHistory() {
            const history = JSON.parse(localStorage.getItem('mfaHistory') || '[]');
            const tbody = document.getElementById('mfaHistoryBody');
            const emptyState = document.getElementById('mfaEmptyState');

            if (history.length === 0) {
                tbody.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';

            // Sort by timestamp (newest first)
            history.sort((a, b) => new Date(b.startTime) - new Date(a.startTime));

            tbody.innerHTML = history.map((attack, index) => {
                const date = new Date(attack.startTime);
                const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
                const timeToApproval = attack.timeToApproval
                    ? `${Math.floor(attack.timeToApproval)}s`
                    : 'N/A';

                return `
                    <tr>
                        <td>${history.length - index}</td>
                        <td class="timestamp-cell">${formattedDate}</td>
                        <td style="font-size: 11px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${escapeHtml(attack.targetUrl || 'N/A')}">
                            ${attack.targetUrl ? escapeHtml(attack.targetUrl) : '<span style="color: #7b7b8c;">N/A</span>'}
                        </td>
                        <td><span class="username-cell">${escapeHtml(attack.targetUser)}</span></td>
                        <td>${attack.pushCount} pushes</td>
                        <td>
                            <span style="color: #51cf66;">${attack.approved} approved</span> /
                            <span style="color: #ffd43b;">${attack.denied} denied</span> /
                            <span style="color: #a0a0b0;">${attack.ignored} ignored</span>
                        </td>
                        <td>${timeToApproval}</td>
                        <td>
                            ${attack.success
                                ? '<span class="badge badge-success">Success</span>'
                                : '<span class="badge badge-warning">Failed</span>'}
                        </td>
                    </tr>
                `;
            }).join('');

            // Update overall stats
            const totalPushes = history.reduce((sum, a) => sum + a.pushCount, 0);
            const totalApproved = history.reduce((sum, a) => sum + a.approved, 0);
            const totalDenied = history.reduce((sum, a) => sum + a.denied, 0);
            const totalIgnored = history.reduce((sum, a) => sum + a.ignored, 0);

            document.getElementById('totalPushes').textContent = totalPushes;
            document.getElementById('approvedPushes').textContent = totalApproved;
            document.getElementById('deniedPushes').textContent = totalDenied;
            document.getElementById('ignoredPushes').textContent = totalIgnored;
        }

        function clearMFAFatigue() {
            document.getElementById('mfaTargetUser').value = '';
            document.getElementById('pushNotificationsContainer').style.display = 'none';
        }

        // Load attack results and MFA history on page load
        loadAttackResults();
        loadMFAHistory();
    </script>
</body>
</html>
